{"version":3,"sources":["assets/script/manager/WxCenter.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import MsgToast from \"../framwork/MsgToast\";\n\nexport default class WxCenter {\n    private static wx:any;\n    private static bannerAd:any;\n    private static videoAd:any;\n    private static videoCallback:Function = null;\n    static init(){\n        this.wx = window && window['wx'];\n        if(!this.wx) return;\n        this.wx.onShareAppMessage(function () {\n            // 用户点击了“转发”按钮\n            return {\n              title: '欢迎加入吃鸡小分队'\n            }\n        })\n        // 提前加载\n        this.showRewardedVideoAd(null,1,true)\n    }\n\n    static isWxEnv(){\n        return window && window['wx'];\n    }\n    //主动\n    static shareAppMessage(callback:Function = null){\n        if(!this.wx) return;\n        this.wx.shareAppMessage({\n            title: '欢迎加入吃鸡小分队'\n        });\n        if(!callback) return;\n        callback['keys'] = new Date().getTime();\n        this.wx.onShow(()=>{\n            let now = new Date().getTime();\n            if(now - callback['keys'] >= 3000){\n                callback();\n            }\n            callback = null;\n        })\n    }\n    \n    static showBanner(){\n        if(!this.wx) return;\n        let wx = this.wx;\n        if(!this.bannerAd){\n            this.bannerAd = wx.createBannerAd({\n                adUnitId: 'xxxx',\n                style: {\n                  left: 10,\n                  top: 76,\n                  width: 320,\n                  adIntervals:30,\n                }\n            })\n            this.bannerAd.onError(err => {\n                console.log(err);\n            });\n        }\n        this.bannerAd.show();\n    }\n\n    static hideBanner(){\n        if(!this.bannerAd) return;\n        this.bannerAd.hide();\n    }\n\n    static showInterstitialAd(){\n        // 定义插屏广告\n        let wx = this.wx;\n        if(!wx) return;\n        let interstitialAd = null\n        // 创建插屏广告实例，提前初始化\n        if (wx.createInterstitialAd){\n            interstitialAd = wx.createInterstitialAd({\n                adUnitId: 'adunit-c64814b155af73e6'\n            })\n        }\n        // 在适合的场景显示插屏广告\n        setTimeout(function () {\n            // 在适合的场景显示插屏广告\n            if (interstitialAd) {\n                interstitialAd.show().then().catch((err) => {\n                    console.error('插屏 广告失败:',err)\n                })\n                interstitialAd.onClose(res => {\n                    console.log('插屏 广告关闭')\n                })\n                interstitialAd.onLoad(() => {\n                    console.log('插屏 广告加载成功')\n                })\n            }\n        }, 3500);\n    }\n\n    static showRewardedVideoAd(callback:Function,type:number,isinit = false){\n        if(!this.wx) {\n            // MsgToast.show(\"看了一个广告\");\n            // callback && callback(true);\n            return;\n        }\n        let wx = this.wx;\n        let adUnitId = ''\n        if(type == 2){\n            adUnitId = 'adunit-cad7de3569109b38'\n        }\n        else{\n            adUnitId = 'adunit-e482dfb01207d492'\n        }\n        this.videoCallback = callback;\n        if(!isinit){\n            wx.showLoading({title:'视频加载中...',mask:true});\n        }\n        setTimeout(() => {\n            wx.hideLoading()\n        }, 3000);\n        let videoAd = wx.createRewardedVideoAd({ adUnitId });\n        if(isinit){\n            videoAd.onClose(res => {\n                // 用户点击了【关闭广告】按钮\n                // 小于 2.1.0 的基础库版本，res 是一个 undefined\n                wx.hideLoading()\n                if (res && res.isEnded || res === undefined) {\n                    // 正常播放结束，可以下发游戏奖励\n                    this.videoCallback && this.videoCallback(true);\n                }\n                else {\n                    // 播放中途退出，不下发游戏奖励\n                }\n            })\n            videoAd.onError(error=>{\n                console.log(error)\n                wx.hideLoading()\n                wx.showToast('视频获取失败');\n            });\n            return;\n        }\n        videoAd.show().then(res=>{\n            // console.log('激励视频 广告显示')\n            videoAd.load().then(() => videoAd.show()).catch(err => {\n                console.log(err)\n                wx.hideLoading()\n                wx.showToast('视频获取失败');\n            })\n        })\n        // 上报\n        // if(videoAd.reportShareBehavior){\n        //     videoAd.reportShareBehavior({\n        //         operation: 2, // 1-曝光 2-点击 3-关闭 4-操作成功 5-操作失败\n        //         currentShow: 0, // 0-广告 1-分享，当 operation 为 1-5 时必填\n        //         strategy: 1, // 0-业务 1-微信策略\n        //         adunit:adUnitId, //当前点位的adunit\n        //         sceneID:type //当前点位的sceneID\n        //     });\n        // }\n    }\n\n    private static videoAdErrHandle(err){\n        console.log('视频加载失败')\n        console.log(err)\n        // {errMsg: \"no advertisement\", errCode: 1004}\n        const errHandle={\n            1000:'后端接口调用失败',\n            1001:'参数错误',\n            1002:'广告单元无效',\n            1003:'内部错误',\n            1004:'无合适的广告',\n            1005:'广告组件审核中',\n            1006:'广告组件被驳回',\n            1007:'广告组件被封禁',\n            1008:'广告单元已关闭',\n        }\n        return errHandle[err.errCode] || '视频加载错误,重新加载页面试试吧'\n    }\n    /**通用统计 */\n    public static aldReport(rid:string,type:string = 'show'){\n        if(!this.wx || !this.wx.aldStage) return;\n        let wx = this.wx;\n        wx.aldSendEvent(rid,{action:type});\n    }\n    \n    public static aldLevelReport(level:number){\n        if(!this.wx || !this.wx.aldStage) return;\n        let wx = this.wx;\n        wx.aldLevel.onSetLevel({\n            levelId: level + '',  // 等级id 必传\n            levelName: `等级${level}`,  // 等级名称 必传\n        });\n        console.log('csdfge2q903423-2-3')\n    }\n\n}"]}