{"version":3,"sources":["assets\\script\\manager\\AdCenter.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Singleton from \"./Singleton\";\r\nimport MsgHints from \"../framwork/MsgHints\";\r\n\r\nimport Utils from '../utils/Utils';\r\nimport WxCenter from \"./WxCenter\";\r\nconst tt = window[\"tt\"];\r\n\r\nconst { ccclass, property } = cc._decorator;\r\nexport default class AdCenter extends Singleton {\r\n    VideoAd = null;\r\n\r\n    bannerAd = null;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        if (tt&& tt.createRewardedVideoAd) {\r\n            this.VideoAd = tt.createRewardedVideoAd({\r\n                adUnitId: '1r3lbfr4d9e6veouju'\r\n            });\r\n\r\n            this.VideoAd.onError((res) => {\r\n                console.log(\"onError\", res);\r\n                MsgHints.show(\"广告加载错误\");\r\n            });\r\n\r\n            this.VideoAd.onLoad(() => {\r\n                // console.log('广告加载成功');\r\n            })\r\n\r\n            this.VideoAd.onClose(res => {\r\n                if (res && res.isEnded || res === undefined) {\r\n                    cc.log(\"正常播放结束，可以下发游戏奖励\")\r\n                    this.callBack(true);\r\n                }\r\n                else {\r\n                    cc.log(\"播放中途退出，不下发游戏奖励\")\r\n                    this.callBack(false);\r\n                }\r\n            })\r\n\r\n            if (tt.createInterstitialAd) {\r\n                this.interstitialAd = tt.createInterstitialAd({\r\n                    adUnitId: '60jin0has9p2b8n774'\r\n                })\r\n            }\r\n\r\n            let { screenWidth, screenHeight } = tt.getSystemInfoSync()\r\n            this.bannerAd = tt.createBannerAd({\r\n                adUnitId: '3a3ld4b071g57lnlji',\r\n                style: { width: screenWidth,\r\n                    top:screenHeight - 150 }\r\n            })\r\n        }\r\n    }\r\n\r\n    interstitialAd = null\r\n    public showinterstitialAd() {\r\n        // 在适合的场景显示插屏广告\r\n        if (this.interstitialAd) {\r\n            this.interstitialAd.show().catch((err) => {\r\n                console.log(err);\r\n            })\r\n        }\r\n    }\r\n\r\n    public showGridAd() \r\n    {\r\n        // if (this.bannerAd)\r\n        //     this.bannerAd.show()\r\n        WxCenter.showBanner();\r\n    }\r\n\r\n    public hideGridAd() {\r\n        // if (this.bannerAd)\r\n        //     this.bannerAd.hide()\r\n        WxCenter.hideBanner();\r\n    }\r\n\r\n    private callBack: Function;\r\n    private _lasttryplaytime: number = 0;\r\n    public play(callback: Function, type:number = 0) {\r\n        if (Utils.getServerTime() - this._lasttryplaytime < 1000) {\r\n            console.log(\"点击过于频繁\")\r\n            return;\r\n        }\r\n        console.log(\"尝试播放广告\")\r\n        this._lasttryplaytime = Utils.getServerTime();\r\n        this.callBack = callback;\r\n        WxCenter.showRewardedVideoAd(callback);\r\n        // this.dyShowVideo();\r\n    }\r\n\r\n    private dyShowVideo(){\r\n        if ( this.VideoAd) {\r\n            this.VideoAd.show().catch(() => {\r\n                this.VideoAd.load()\r\n                    .then(() => this.VideoAd.show())\r\n                    .catch(err => {\r\n                        cc.log('激励视频 广告显示失败');\r\n                        this.callBack(false);\r\n                    })\r\n            })\r\n        }\r\n        else {\r\n            this.callBack(true);\r\n        }\r\n    }\r\n\r\n}"]}