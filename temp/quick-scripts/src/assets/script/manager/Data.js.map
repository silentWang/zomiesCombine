{"version":3,"sources":["assets\\script\\manager\\Data.ts"],"names":[],"mappings":";;;;;;AACA,+CAA0C;AAC1C,wCAAmC;AACnC,8CAAyC;AACzC,+CAA0C;AAE1C;IAAA;IA+CA,CAAC;IA5CiB,SAAI,GAAlB,UAAoB,OAAwB;QAAxB,wBAAA,EAAA,eAAwB;QACxC,IAAI,GAAG,GAAG,EAAE,CAAA;QACZ,GAAG,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAA;QACvC,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,OAAO,CAAC,CAAA;QAE3B,OAAO;QACP,sBAAsB;QACtB,yCAAyC;QACzC,4EAA4E;QAC5E,SAAS;QACT,IAAI;IACR,CAAC;IACa,aAAQ,GAAtB;QACI,IAAI,SAAS,GAAG,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,mBAAS,CAAC,cAAc,CAAC,CAAC;QACtE,IAAI,SAAS,EAAE;YACX,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;YAClC,iCAAiC;YACjC,IAAI,YAAY,GAAG,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;YAAA,CAAC;YAChE,IAAG,YAAY,GAAG,CAAC,EAAC;gBAChB,IAAI,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;gBAC/B,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,OAAO,EAAE,CAAC;gBACzC,IAAG,GAAG,IAAI,CAAC,EAAC;oBACR,SAAS,CAAC,WAAW,GAAG,EAAE,CAAC;oBAC3B,SAAS,CAAC,mBAAmB,GAAG,CAAC,CAAC;oBAClC,SAAS,CAAC,oBAAoB,GAAG,CAAC,CAAC;iBACtC;aACJ;YACD,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;SACxC;aACI;YACD,aAAa;YACb,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;YAC5C,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;YAC5C,kBAAQ,CAAC,QAAQ,EAAE,CAAC,SAAS,GAAG,CAAC,CAAC;YAClC,kBAAQ,CAAC,QAAQ,EAAE,CAAC,SAAS,GAAG,CAAC,CAAC;SACrC;IACL,CAAC;IAED,OAAO;IACQ,aAAQ,GAAvB,UAAwB,IAAI,EAAE,OAAwB;QAAxB,wBAAA,EAAA,eAAwB;QAClD,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,cAAc,EAAE,eAAK,CAAC,aAAa,EAAE,CAAC,CAAC;QACnE,IAAI,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACnC,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,mBAAS,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;IACnE,CAAC;IA7Ca,SAAI,GAAc,IAAI,mBAAS,EAAE,CAAC;IA8CpD,WAAC;CA/CD,AA+CC,IAAA;kBA/CoB,IAAI;AAiDzB,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAA","file":"","sourceRoot":"/","sourcesContent":["\r\nimport UserModel from \"../game/UserModel\";\r\nimport Utils from \"../utils/Utils\";\r\nimport AudioMgr from \"../utils/AudioMgr\";\r\nimport GameConst from \"../game/GameConst\";\r\n\r\nexport default class Data {\r\n    public static user: UserModel = new UserModel();\r\n\r\n    public static save( bRemote: boolean = false) {\r\n        var obj = {}\r\n        obj['user'] = Data.user.getUploadData()\r\n        Data.savedata(obj, bRemote)\r\n\r\n        //上传服务器\r\n        // if (window[\"wx\"]) {\r\n        //     window[\"wx\"].setUserCloudStorage({\r\n        //         KVDataList: [{ key: \"lv\", value: Math.floor(this.user.lv) + \"\" }]\r\n        //     })\r\n        // }\r\n    }\r\n    public static loadData() {\r\n        var localdata = cc.sys.localStorage.getItem(GameConst.local_data_key);\r\n        if (localdata) {\r\n            localdata = JSON.parse(localdata);\r\n            // console.log('本地数据', localdata)\r\n            let savedatatime = cc.sys.localStorage.getItem(\"savedatatime\");;\r\n            if(savedatatime > 0){\r\n                let now = new Date().getDate();\r\n                let d = new Date(savedatatime).getDate();\r\n                if(now != d){\r\n                    localdata.share_times = 10;\r\n                    localdata.today_getcoin_times = 0;\r\n                    localdata.today_getchick_times = 0;\r\n                }\r\n            }\r\n            Data.user.setData(localdata['user']);\r\n        }\r\n        else {\r\n            //没有档案重置下音乐开关\r\n            cc.sys.localStorage.setItem(\"bgmVolume\", 1);\r\n            cc.sys.localStorage.setItem(\"sfxVolume\", 1);\r\n            AudioMgr.Instance().sfxVolume = 1;\r\n            AudioMgr.Instance().bgmVolume = 1;\r\n        }\r\n    }\r\n\r\n    //本地存数据\r\n    private static savedata(data, bRemote: boolean = false) {\r\n        cc.sys.localStorage.setItem(\"savedatatime\", Utils.getServerTime());\r\n        var strdata = JSON.stringify(data);\r\n        cc.sys.localStorage.setItem(GameConst.local_data_key, strdata);\r\n    }\r\n}\r\n\r\nwindow['Data'] = Data"]}