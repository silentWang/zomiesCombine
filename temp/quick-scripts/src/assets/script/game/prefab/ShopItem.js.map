{"version":3,"sources":["assets\\script\\game\\prefab\\ShopItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import BaseUI from \"../../framwork/BaseUI\";\r\nimport ListItem from \"../../framwork/ListItem\";\r\nimport MsgHints from \"../../framwork/MsgHints\";\r\nimport AdCenter from \"../../manager/AdCenter\";\r\nimport Data from \"../../manager/Data\";\r\nimport AudioMgr from \"../../utils/AudioMgr\";\r\nimport Utils from \"../../utils/Utils\";\r\nimport GameConst from \"../GameConst\";\r\nimport HallScene from \"../HallScene\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\nenum GunBuyType {\r\n    CAN_BUY = 1,\r\n    CAN_AD_BUY= 2,\r\n    ONLY_CHECK= 4,\r\n    // CNNOT_SEE= 8,\r\n    GEM_BUY= 16,\r\n}\r\n\r\n\r\n@ccclass\r\nexport default class ShopItem extends BaseUI {\r\n\r\n    //观看视频免费获得的枪械等级\r\n    private WatchAdBuy(id:number):boolean\r\n    {\r\n        var gunlv = Data.user.GetMaxLv();\r\n        if(gunlv < 8)return false;\r\n        return gunlv - 4 == id;\r\n    }\r\n\r\n    //不可指定购买只可查看的区间\r\n    private OnlyCheck(id:number):boolean\r\n    {\r\n        var gunlv = Data.user.GetMaxLv();\r\n        if(gunlv - 2 <= id && id <= gunlv )\r\n        {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    private BuyGem(id:number):boolean\r\n    {\r\n        var gunlv = Data.user.GetMaxLv();\r\n        return gunlv - 1 == id;\r\n    }\r\n\r\n    private getBuyType(gun)\r\n    {\r\n        var gunlv = Data.user.GetMaxLv()\r\n        var type:number = 0;\r\n        if(gun[0] <= gunlv - 2)\r\n        {\r\n            type |= GunBuyType.CAN_BUY;\r\n        }\r\n        if(this.WatchAdBuy(gun[0]))\r\n        {\r\n            type |= GunBuyType.CAN_AD_BUY;\r\n        }\r\n        if(this.BuyGem(gun[0]))\r\n        {\r\n            type |= GunBuyType.GEM_BUY;\r\n        }\r\n        if(this.OnlyCheck(gun[0]))\r\n        {\r\n            type |= GunBuyType.ONLY_CHECK;\r\n        }\r\n\r\n        return type;\r\n    }\r\n\r\n\r\n    private cost_coin:number = 0;\r\n    private cost_gem:number = 0;\r\n    gun:any = null;\r\n    async setItemData(gun:any)\r\n    {   \r\n        // [\"level\", \"cd\", \"power\", \"skill\", \"offline\", \"price\", \"gem\", \"prefab\", \"shootPos\", \"steakColor\", \"head\"]\r\n        let node = null;\r\n        let bhide = false;\r\n        let buytype = this.getBuyType(gun);\r\n        this.gun = gun;\r\n\r\n        this.GetGameObject(\"show\").active = false;\r\n        this.GetGameObject(\"hide\").active = false;\r\n\r\n        this.GetGameObject(\"btn_gem\").active = false;\r\n        this.GetGameObject(\"btn_yellow\").active = false;\r\n        this.GetGameObject(\"btn_free\").active = false;\r\n        this.GetGameObject(\"btn_gray\").active = false;\r\n\r\n        this.cost_gem = Math.min(gun[6],5);\r\n        if((buytype & GunBuyType.GEM_BUY) != 0 && gun[6]>0)\r\n        {\r\n            this.GetGameObject(\"show\").active = true;\r\n\r\n            this.GetGameObject(\"btn_gem\").active = true;\r\n            node = this.GetGameObject(\"show\");\r\n        }\r\n        else if((buytype & GunBuyType.CAN_AD_BUY) != 0)\r\n        {\r\n            this.GetGameObject(\"show\").active = true;\r\n            this.GetGameObject(\"btn_free\").active = true;\r\n            node = this.GetGameObject(\"show\");\r\n        }\r\n        else if((buytype & GunBuyType.CAN_BUY) != 0)\r\n        {\r\n            this.GetGameObject(\"show\").active = true;\r\n            this.GetGameObject(\"btn_yellow\").active = true;\r\n\r\n           \r\n            node = this.GetGameObject(\"show\");\r\n        }\r\n        else\r\n        {\r\n            if((buytype & GunBuyType.ONLY_CHECK) != 0)\r\n            {\r\n                this.GetGameObject(\"show\").active = true;\r\n                this.GetGameObject(\"btn_gray\").active = true;\r\n                node = this.GetGameObject(\"show\");\r\n            }\r\n            else\r\n            {\r\n                this.GetGameObject(\"hide\").active = true;\r\n                node = this.GetGameObject(\"hide\");\r\n                bhide = true;\r\n            }\r\n        }\r\n\r\n        this._findInChildren(node,\"lbl_lv\").getComponent(cc.Label).string = \"\"+gun[0];\r\n        this._findInChildren(node,\"New Label\").getComponent(cc.Label).string = \"\"+(gun[0]+2);\r\n\r\n        let skill = gun[3].split(\"|\");\r\n        let skilltype = skill[0];\r\n        let value = skill[1];\r\n\r\n        let str = \"\";\r\n\r\n        if(bhide)value = \"?\"\r\n        if(skilltype == 1)\r\n        {\r\n            str =\"技能:\" + value+\"%的几率触发减速目标1秒\";\r\n        }\r\n        else if(skilltype == 2){\r\n            str =\"技能:\" + value+\"%几率对目标造成双倍伤害\";\r\n        }\r\n        else if(skilltype == 3){\r\n            str =\"技能:\" + value+\"%几率冰冻目标1秒\";\r\n        }\r\n\r\n        this._findInChildren(node,\"lbl_name\").getComponent(cc.Label).string = str;\r\n        this._findInChildren(node,\"lbl_cd\").getComponent(cc.Label).string =bhide?\"?\": gun[1]+\"\";\r\n        this._findInChildren(node,\"lbl_power\").getComponent(cc.Label).string = bhide?\"?\":Utils.formatNumber(gun[2])+\"\";\r\n        this._findInChildren(node,\"gun\").getComponent(cc.Sprite).spriteFrame = await Utils.loadRes(\"texture/plants/\"+(gun[0]-1),cc.SpriteFrame) as cc.SpriteFrame;\r\n        this._findInChildren(node,\"gun\").getComponent(cc.Sprite).spriteFrame = await Utils.loadRes(\"texture/plants/\"+(gun[0]-1),cc.SpriteFrame) as cc.SpriteFrame;\r\n       \r\n        if(gun[0]+1<60)\r\n        {\r\n            this._findInChildren(node,\"0\").getComponent(cc.Sprite).spriteFrame = await Utils.loadRes(\"texture/plants/\"+(gun[0]+1),cc.SpriteFrame) as cc.SpriteFrame;\r\n        }\r\n        else\r\n        {\r\n            this._findInChildren(node,\"0\").getComponent(cc.Sprite).spriteFrame = await Utils.loadRes(\"texture/plants/59\",cc.SpriteFrame) as cc.SpriteFrame;\r\n        }\r\n        \r\n        this.cost_coin = Data.user.BuyPrice(gun[0])\r\n        this.SetText(\"lbl_buy_coin\",Utils.formatNumber( this.cost_coin));\r\n        this.GetButton(\"btn_yellow\").interactable = Data.user.coin >= this.cost_coin;\r\n        this.SetText(\"lbl_buy_gem\",Utils.formatNumber( this.cost_gem));    //钻石产出少，最多就5个钻石吧\r\n        // if(Utils.getServerTime() - DataManager.Instance().lastShareGetGunTime < GAME_CONFIG.SHARE_GET_GUN_TIME)\r\n        // {\r\n        //     this.GetGameObject(\"btn_free\").active = false;\r\n        // }\r\n    }\r\n    \r\n    onBtnClicked(event, customEventData) {\r\n        super.onBtnClicked(event,customEventData);\r\n        var btnName = event.target.name;\r\n        \r\n        AudioMgr.Instance().playSFX(\"click\");\r\n        switch (btnName) {\r\n            case \"btn_free\":\r\n                AdCenter.Instance().play(0,(b)=>{\r\n                    if(b)\r\n                    {\r\n                        if(HallScene.Instance.tryBuyPlant(this.gun[0],2))\r\n                        {\r\n                           MsgHints.show(\"购买成功\");\r\n                           this.dispatch(GameConst.BUY_PLANT,this.gun,this.node.getComponent(ListItem).listId);\r\n                        }\r\n                    }\r\n                })\r\n                break\r\n            case \"btn_yellow\":\r\n                if(Data.user.coin < this.cost_coin )\r\n                {\r\n                    MsgHints.show(\"金币不足\")\r\n                    return;\r\n                }\r\n                if(HallScene.Instance.tryBuyPlant(this.gun[0],0))\r\n                {\r\n                    MsgHints.show(\"购买成功\");\r\n                    this.dispatch(GameConst.BUY_PLANT,this.gun,this.node.getComponent(ListItem).listId);\r\n                }\r\n                break;\r\n            case \"btn_gem\":\r\n                if(Data.user.gem < this.cost_gem )\r\n                {\r\n                    MsgHints.show(\"钻石不足\")\r\n                    return;\r\n                }\r\n                if(HallScene.Instance.tryBuyPlant(this.gun[0],1))\r\n                {\r\n                    MsgHints.show(\"购买成功\");\r\n                    this.dispatch(GameConst.BUY_PLANT,this.gun,this.node.getComponent(ListItem).listId);\r\n                }\r\n                break\r\n        }\r\n    }\r\n}\r\n"]}