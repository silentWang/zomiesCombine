{"version":3,"sources":["assets\\script\\game\\prefab\\ShareView.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAElF,gDAA2C;AAC3C,qDAAgD;AAChD,mDAA8C;AAC9C,iDAA4C;AAC5C,uDAAkD;AAClD,2CAAsC;AAEhC,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAuC,6BAAM;IAA7C;;IA6CA,CAAC;IAzCG,yBAAK,GAAL;QAEI,eAAK,CAAC,UAAU,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,CAAA;IACrD,CAAC;IAED,6BAAS,GAAT;QAEI,iBAAM,SAAS,WAAE,CAAC;IACtB,CAAC;IAED,2BAAO,GAAP;QACI,IAAI,EAAE,GAAG,mBAAS,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,mBAAS,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACjF,IAAI,CAAC,OAAO,GAAG,GAAG,GAAC,mBAAS,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;QACpD,IAAI,IAAI,GAAG,qBAAW,CAAC,cAAc,CAAC,eAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;QACpE,IAAI,KAAK,GAAG,mBAAS,CAAC,IAAI,CAAC,WAAW,CAAC;QACvC,IAAI,CAAC,OAAO,CAAC,UAAU,EAAC,IAAI,CAAC,CAAA;QAC7B,IAAI,CAAC,OAAO,CAAC,WAAW,EAAC,6BAAO,KAAK,WAAG,CAAC,CAAC;IAC9C,CAAC;IAED,+BAAW,GAAX,UAAY,KAAK,EAAE,eAAe;QAAlC,iBAqBC;QApBG,IAAI,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC;QAChC,kBAAQ,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QACpC,QAAQ,OAAO,EAAE;YACb,KAAK,WAAW;gBACZ,IAAI,CAAC,OAAO,EAAE,CAAC;gBACf,MAAM;YACV,KAAK,WAAW;gBACZ,kBAAQ,CAAC,eAAe,CAAC;oBACrB,IAAG,mBAAS,CAAC,IAAI,CAAC,WAAW,GAAG,CAAC,EAAC;wBAC9B,mBAAS,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;wBAC7B,kBAAQ,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;wBACnC,eAAK,CAAC,OAAO,CAAC,CAAC,EAAC,KAAI,CAAC,IAAI,EAAC,WAAW,EAAC,eAAK,CAAC,YAAY,CAAC,CAAC,EAAC,EAAE,CAAC,EAAC,GAAG,EAAC,UAAC,CAAC;4BACjE,IAAG,CAAC;gCAAE,mBAAS,CAAC,IAAI,CAAC,IAAI,IAAI,KAAI,CAAC,OAAO,CAAC;4BAC1C,mBAAS,CAAC,IAAI,EAAE,CAAC;wBACrB,CAAC,CAAC,CAAA;qBACL;oBACD,KAAI,CAAC,OAAO,EAAE,CAAC;gBACnB,CAAC,CAAC,CAAC;gBACH,MAAM;SACT;IACT,CAAC;IA5CgB,SAAS;QAD7B,OAAO;OACa,SAAS,CA6C7B;IAAD,gBAAC;CA7CD,AA6CC,CA7CsC,gBAAM,GA6C5C;kBA7CoB,SAAS","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport BaseUI from \"../../framwork/BaseUI\";\r\nimport ChickData from \"../../manager/ChickData\";\r\nimport WxCenter from \"../../manager/WxCenter\";\r\nimport AudioMgr from \"../../utils/AudioMgr\";\r\nimport NumberUtils from \"../../utils/NumberUtils\";\r\nimport Utils from \"../../utils/Utils\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ShareView extends BaseUI {\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    private coinVal:number;\r\n    start()\r\n    {\r\n        Utils.playBreath(this.GetGameObject('btn_share'))\r\n    }\r\n\r\n    onDestroy()\r\n    {\r\n        super.onDestroy();\r\n    }\r\n\r\n    setData(){\r\n        let lv = ChickData.user.getLvlMax() - 1 > 0 ? ChickData.user.getLvlMax() - 1 : 1;\r\n        this.coinVal = 0.5*ChickData.user.buyChickPrice(lv);\r\n        let coin = NumberUtils.getLargeString(Utils.fixFloat(this.coinVal));\r\n        let times = ChickData.user.share_times;\r\n        this.SetText(\"lbl_coin\",coin)\r\n        this.SetText(\"lbl_times\",`还可分享${times}次`);\r\n    }\r\n\r\n    onUIClicked(event, customEventData) {\r\n        var btnName = event.target.name;\r\n        AudioMgr.Instance().playMX(\"click\");\r\n        switch (btnName) {\r\n            case \"btn_close\":\r\n                this.closeUI();\r\n                break;\r\n            case \"btn_share\":\r\n                WxCenter.shareAppMessage(()=>{\r\n                    if(ChickData.user.share_times > 0){\r\n                        ChickData.user.share_times--;\r\n                        AudioMgr.Instance().playMX(\"coin\");\r\n                        Utils.flyAnim(0,this.node,\"icon_coin\",Utils.getRandomInt(5,10),100,(b)=>{\r\n                            if(b) ChickData.user.coin += this.coinVal;\r\n                            ChickData.save();\r\n                        })\r\n                    }\r\n                    this.closeUI();\r\n                });\r\n                break;\r\n            }\r\n    }\r\n}\r\n"]}