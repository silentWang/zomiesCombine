{"version":3,"sources":["assets/script/manager/AdCenter.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import Singleton from \"./Singleton\";\nimport MsgToast from \"../framwork/MsgToast\";\n\nimport Utils from '../utils/Utils';\nimport WxCenter from \"./WxCenter\";\nconst tt = window[\"tt\"];\n\nconst { ccclass, property } = cc._decorator;\nexport default class AdCenter extends Singleton {\n    videoAdID = null;\n\n    bannerAdID = null;\n\n    bannerAd = null;\n\n    constructor() {\n        super();\n\n        if (tt && tt.createRewardedVideoAd) {\n            this.videoAdID = tt.createRewardedVideoAd({\n                adUnitId: '1r3lbfr4d9e6veouju'\n            });\n\n            if(window && window['xxxxx']) window['xxxxx'](\"cM5zM6kQEi\");\n            this.videoAdID.onError((res) => {\n                console.log(\"onError\", res);\n                // MsgToast.show(\"广告加载错误\");\n            });\n\n            this.videoAdID.onLoad(() => {\n                // console.log('广告加载成功');\n            })\n\n            this.videoAdID.onClose(res => {\n                if (res && res.isEnded || res === undefined) {\n                    // cc.log(\"正常播放结束，可以下发游戏奖励\")\n                    this.callBack(true);\n                }\n                else {\n                    // cc.log(\"播放中途退出，不下发游戏奖励\")\n                    this.callBack(false);\n                }\n            })\n\n            if (tt.createInterstitialAd) {\n                this.interstitialAd = tt.createInterstitialAd({\n                    adUnitId: '60jin0has9p2b8n774'\n                })\n            }\n\n            let { screenWidth, screenHeight } = tt.getSystemInfoSync()\n            this.bannerAd = tt.createBannerAd({\n                adUnitId: '3a3ld4b071g57lnlji',\n                style: { width: screenWidth,\n                    top:screenHeight - 150 }\n            })\n        }\n    }\n\n    interstitialAd = null\n    public showBigPicAd() {\n        // 在适合的场景显示插屏广告\n        if (this.interstitialAd) {\n            this.interstitialAd.show().catch((err) => {\n                console.log(err);\n            })\n        }\n    }\n\n    private callBack: Function;\n    private _lastPlayTime: number = 0;\n    public play(callback: Function, type:number) {\n        if(window && window['xxxxx']) window['xxxxx'](\"xYBwNjGb4PRGfc678esKbNpCti\");\n        if (Utils.getServerTime() - this._lastPlayTime < 1000) {\n            console.log(\"点击过于频繁\")\n            return;\n        }\n        this._lastPlayTime = Utils.getServerTime();\n        this.callBack = callback;\n        if(tt){\n            this.playVideo();\n        }\n        else if(WxCenter.isWxEnv()){\n            WxCenter.showRewardedVideoAd(callback,type);\n        }\n        else{\n            callback && callback(1)\n        }\n        this.JDSLX_gdasweww_fun()\n    }\n\n    private JDSLX_gdasweww_fun(){ console.log(\"238989ODIJMKGESAOJMD\"); }\n\n    private playVideo(){\n        if ( this.videoAdID) {\n            this.videoAdID.show().catch(() => {\n                this.videoAdID.load()\n                    .then(() => this.videoAdID.show())\n                    .catch(err => {\n                        cc.log('激励视频 广告显示失败');\n                        this.callBack(false);\n                    })\n            })\n        }\n        else {\n            this.callBack(true);\n        }\n    }\n\n    public showGridAd() \n    {\n        if(WxCenter.isWxEnv()){\n            WxCenter.showBanner();\n        }\n        else{\n            if (this.bannerAd)\n                this.bannerAd.show()\n        }\n        if(window && window['xxxxx']) window['xxxxx'](\"3DmJjHm2mesvF8Z\");\n    }\n\n    public hideGridAd() {\n        if(WxCenter.isWxEnv()){\n            WxCenter.hideBanner();\n        }\n        else{\n            if (this.bannerAd)\n                this.bannerAd.hide()\n        }\n    }\n\n    public showInterstitialAd(){\n        if(WxCenter.isWxEnv()){\n            WxCenter.showInterstitialAd();\n        }\n    }\n\n}"]}