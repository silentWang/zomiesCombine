{"version":3,"sources":["assets\\script\\utils\\Native.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import GameEvent from \"../event/GameEvent\";\r\nimport GameConst from \"../game/GameConst\";\r\nimport ChickData from \"../manager/ChickData\";\r\nexport enum VIP_TYPE  {\r\n    VIP_MONTH = 'hw_vip_003',\r\n    VIP_FOREVER = 'hw_vip_004',\r\n    RECOVER_VIP = '3'\r\n}\r\nexport default class Native {\r\n    static callAppMethod(methodName:string,params:any = '',callback:Function = null){\r\n        if(cc.sys.os !== cc.sys.OS_IOS) return;\r\n        let callfunc = 'callBackFunc_' + new Date().getTime();\r\n        window[callfunc] = (res)=>{\r\n            console.log(`---ios callback---${methodName}`,res)\r\n            let rep = (!res || res == 'undefined') ? '' : res\r\n            callback && callback(rep);\r\n            window[callfunc] = null;\r\n        }\r\n        let obj = {method:callfunc,params};\r\n        let json = JSON.stringify(obj);\r\n        let methodstr = `${methodName}${json}`;\r\n        console.log(`--ios callback before---:${methodName}---${methodstr}`)\r\n        if(!jsb || !jsb.reflection || !jsb.reflection.callStaticMethod) {\r\n            console.log('HWGameJSHandle:找不到jsb')\r\n            return;\r\n        }\r\n        jsb.reflection.callStaticMethod('HWGameJSHandle',`${methodName}:`,json)\r\n    }\r\n    /**视频广告 */\r\n    static playVideoAd(callback:Function,adUnitId:string){\r\n        if(ChickData.isFreeAd){\r\n            callback && callback(1);\r\n            return;\r\n        }\r\n        this.callAppMethod('loadTopOnRewardAd',{adUnitId},(res)=>{\r\n            if(res && res.status == 200){\r\n                callback && callback(1);\r\n            }\r\n            else{\r\n                callback && callback();\r\n            }\r\n        });\r\n    }\r\n    /**插屏广告 */\r\n    static showInterstitialAd(adUnitId:string,callback:Function = null){\r\n        this.callAppMethod('loadTopOnInterstitialAd',{adUnitId},(res)=>{\r\n            callback && callback();\r\n        });\r\n    }\r\n    /**banner广告 */\r\n    static showBannerAd(adUnitId:string,callback:Function = null){\r\n        this.callAppMethod('loadBannerAd',{adUnitId},(res)=>{\r\n            callback && callback();\r\n        });\r\n    }\r\n    \r\n    static hideBannerAd(){\r\n        this.callAppMethod('hideBannerAd');\r\n    }\r\n    \r\n    /**月卡購買 */\r\n    static buyMonthCard(type:string,callback:Function = null){\r\n        this.callAppMethod('hwIAP',type,(res)=>{\r\n            callback && callback(res)\r\n            if(res.code != 0) return;\r\n            if(res.type == VIP_TYPE.RECOVER_VIP || res.type == VIP_TYPE.VIP_FOREVER || res.type == VIP_TYPE.VIP_MONTH){\r\n                ChickData.isFreeAd = true;\r\n            }\r\n            GameEvent.Instance().dispatch(GameConst.FREE_AD_EVENT)\r\n        })\r\n    }\r\n    /**get buy info */\r\n    static getMyMonthInfo(callback:Function = null){\r\n        callback && callback()\r\n        return;\r\n        // this.callAppMethod('getVipInfo','',(res)=>{\r\n        //     callback && callback(res)\r\n        //     if(res.type == VIP_TYPE.RECOVER_VIP || res.type == VIP_TYPE.VIP_FOREVER || res.type == VIP_TYPE.VIP_MONTH){\r\n        //         ChickData.isFreeAd = true;\r\n        //     }\r\n        //     GameEvent.Instance().dispatch(GameConst.FREE_AD_EVENT)\r\n        // })\r\n    }\r\n    /**open webview */\r\n    static openWebView(url:string){\r\n        this.callAppMethod('hw_openH5',{url});\r\n    }\r\n    /**setlocal */\r\n    static saveDataToApp(json:string){\r\n        if(cc.sys.os === cc.sys.OS_IOS){\r\n            this.callAppMethod('setCacheData',{userdata:json});\r\n        }\r\n        else{\r\n            cc.sys.localStorage.setItem(GameConst.cache_chick_data_key,JSON.stringify({userdata:json}))\r\n        }\r\n    }\r\n    /**getlocal */\r\n    static getDataFromApp(callback:Function){\r\n        if(cc.sys.os === cc.sys.OS_IOS){\r\n            this.callAppMethod('getCacheData','',(res)=>{\r\n                if(res && res.userdata){\r\n                    callback && callback(JSON.parse(res.userdata));\r\n                }\r\n                else{\r\n                    callback && callback(null);\r\n                }\r\n            });\r\n        }\r\n        else{\r\n            let res = cc.sys.localStorage.getItem(GameConst.cache_chick_data_key)\r\n            let userdata = null;\r\n            if(res){\r\n                let data = JSON.parse(res);\r\n                if(data.userdata){\r\n                    userdata = JSON.parse(data.userdata)\r\n                }\r\n            }\r\n            callback && callback(userdata);\r\n        }\r\n    }\r\n}"]}