{"version":3,"sources":["assets\\script\\game\\SlotItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import BaseUI from '../framwork/BaseUI';\r\nimport Data from '../manager/Data';\r\nimport { DB_slot } from './DB';\r\nimport Utils from '../utils/Utils';\r\nimport MsgHints from '../framwork/MsgHints';\r\nimport GameConst from './GameConst';\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class SlotItem extends BaseUI {\r\n\r\n    static getCurOpen()\r\n    {\r\n        let curopen = -1\r\n        for(var i= 1;i<12;++i)\r\n        {\r\n            if(Data.user.slots[i] == 0)\r\n            {\r\n                curopen = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return curopen;\r\n\r\n    }\r\n\r\n    onBtnClicked(event, customEventData) {\r\n        let curopen = SlotItem.getCurOpen();\r\n        if(curopen == -1)return;\r\n        if(this.index-1 > curopen )\r\n        {\r\n            MsgHints.show(\"需要先解锁\"+(curopen+1));\r\n            return;\r\n        }\r\n\r\n        let type = DB_slot[curopen].type;\r\n        if(type == 0)\r\n        {\r\n            if(Data.user.coin < DB_slot[curopen].price)\r\n            {\r\n                MsgHints.show(\"金币不足\");\r\n                return\r\n            }\r\n        }\r\n        else\r\n        {\r\n            if(Data.user.gem < DB_slot[curopen].price)\r\n            {\r\n                MsgHints.show(\"钻石不足\");\r\n                return\r\n            }\r\n        }\r\n\r\n        Data.user.slots[curopen] = 1;\r\n        if(type == 0)\r\n        {\r\n            Data.user.coin -= DB_slot[curopen].price\r\n        }\r\n        else\r\n        {\r\n            Data.user.gem -= DB_slot[curopen].price\r\n        }\r\n        console.log(\"解锁土地\",curopen)\r\n        Data.save();\r\n        this.dispatch(GameConst.OPEN_SLOT,curopen);\r\n        this.setIndex(this.index);\r\n    }\r\n\r\n\r\n    private index = 0;\r\n    setIndex(i)\r\n    {\r\n        this.index = i;\r\n        this.SetText(\"lbl_index\",i+\"\");\r\n        // console.log(i,Data.user.slots[i])\r\n        let curopen = SlotItem.getCurOpen();\r\n        this.node.getComponent(cc.Button).interactable = this.index-1>=curopen && curopen !=-1;\r\n\r\n        // this.GetSkeleton(\"fx_slot\").setAnimation(0,\"buy\",true)\r\n        // this.GetGameObject(\"fx_slot\").active = false;\r\n        let info = Data.user.slots[i-1];\r\n\r\n        this.GetGameObject(\"lock\").active = info == 0;\r\n        this.GetGameObject(\"lbl_index\").active = info == 0;\r\n        this.GetGameObject(\"node_cost\").active = info == 0;\r\n\r\n        this.GetGameObject(\"2btcoin\").active = DB_slot[i-1].type == 0;\r\n        this.GetGameObject(\"2btdiamond\").active = DB_slot[i-1].type == 1;\r\n        this.SetText(\"lbl_open_cost\",Utils.formatNumber( DB_slot[i-1].price))\r\n    }\r\n}\r\n"]}